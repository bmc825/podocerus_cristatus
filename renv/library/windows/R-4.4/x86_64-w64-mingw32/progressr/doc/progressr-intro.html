
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Two Minimal APIs - One For Developers and One For End-Users &#8212; Chapter 3 Data Analysis</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../../../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'renv/library/windows/R-4.4/x86_64-w64-mingw32/progressr/doc/progressr-intro';</script>
    <link rel="index" title="Index" href="../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../../../../_static/Podocerus_bw.png" class="logo__image only-light" alt="Chapter 3 Data Analysis - Home"/>
    <img src="../../../../../../../_static/Podocerus_bw.png" class="logo__image only-dark pst-js-only" alt="Chapter 3 Data Analysis - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../../../../intro.html">
                    Data Analysis of P. cristatus
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../scripts/Load_Packages.html">Load Packages</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../../../../01_Population/01_intro.html">Question 1</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../01_Population/01_data_cleaning.html">Data Cleaning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../01_Population/Clustering.html">Cluster Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../01_Population/Population_structure.html">Population Structure Analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../../../../02_Occurrence/02_intro.html">Question 2</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../02_Occurrence/02_data_cleaning.html">Data Cleaning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../02_Occurrence/Model_1.html">Model 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../02_Occurrence/Model_2.html">Model 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../02_Occurrence/Model_3.html">Model 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../02_Occurrence/Model_exp.html">Substrate Experiment Model</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../../../../03_Camouflage/03_intro.html">Question 3</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../03_Camouflage/03_data_cleaning.html">Data Cleaning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../03_Camouflage/Model_4.html">Model 4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../03_Camouflage/Model_5.html">Model 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../03_Camouflage/Model_6.html">Model 6</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../../../../04_Phylogenetic/04_intro.html">Question 4</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../04_Phylogenetic/Geneious_protocol.html">Geneious Protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../04_Phylogenetic/Phylogenetic_analysis.html">Phylogenetic Analysis</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../../../../_sources/renv/library/windows/R-4.4/x86_64-w64-mingw32/progressr/doc/progressr-intro.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Two Minimal APIs - One For Developers and One For End-Users</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Two Minimal APIs - One For Developers and One For End-Users</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-example">A simple example</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#without-reporting-on-progress">Without reporting on progress</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reporting-on-progress">Reporting on progress</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#customizing-how-progress-is-reported">Customizing how progress is reported</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#terminal-based-progress-bars">Terminal-based progress bars</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#auditory-progress-updates">Auditory progress updates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concurrent-auditory-and-visual-progress-updates">Concurrent auditory and visual progress updates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#silence-all-progress">Silence all progress</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-configuration-of-progress-handlers">Further configuration of progress handlers</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#sticky-messages">Sticky messages</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#use-regular-output-as-usual-alongside-progress-updates">Use regular output as usual alongside progress updates</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#support-for-progressr-elsewhere">Support for progressr elsewhere</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#base-r-apply-functions">Base R Apply Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-foreach-package">The foreach package</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-purrr-package">The purrr package</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-plyr-package">The plyr package</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-knitr-package">The knitr package</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#replace-any-cli-progress-bars-with-progressr-updates">Replace any cli progress bars with progressr updates</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel-processing-and-progress-updates">Parallel processing and progress updates</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#future-lapply-parallel-lapply">future_lapply() - parallel lapply()</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#foreach-with-dofuture">foreach() with doFuture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#future-map-parallel-purrr-map">future_map() - parallel purrr::map()</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biocparallel-bplapply-parallel-lapply">BiocParallel::bplapply() - parallel lapply()</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plyr-llply-parallel-true-with-dofuture">plyr::llply(…, .parallel = TRUE) with doFuture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#near-live-versus-buffered-progress-updates-with-futures">Near-live versus buffered progress updates with futures</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#note-of-caution-sending-progress-updates-too-frequently">Note of caution - sending progress updates too frequently</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#progress-updates-in-non-interactive-mode-batch-mode">Progress updates in non-interactive mode (“batch mode”)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#roadmap">Roadmap</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix">Appendix</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#known-issues">Known issues</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-progressor-cannot-be-created-in-the-global-environment">A progressor cannot be created in the global environment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-global-progress-handler-cannot-be-set-everywhere">The global progress handler cannot be set everywhere</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#under-the-hood">Under the hood</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#debugging">Debugging</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <!--
%\VignetteIndexEntry{progressr: An Introduction}
%\VignetteAuthor{Henrik Bengtsson}
%\VignetteKeyword{R}
%\VignetteKeyword{package}
%\VignetteKeyword{vignette}
%\VignetteKeyword{Rprofile}
%\VignetteKeyword{Renviron}
%\VignetteEngine{progressr::selfonly}
-->
<!-- DO NOT EDIT THIS FILE! Edit 'OVERVIEW.md' instead and then rebuild this file with 'make vigs' -->
<p>The <strong><a class="reference external" href="https://cran.r-project.org/package=progressr">progressr</a></strong> package provides a minimal API for reporting
progress updates in <a class="reference external" href="https://www.r-project.org/">R</a>.  The design is to
separate the representation of progress updates from how they are
presented.  What type of progress to signal is controlled by the
developer.  How these progress updates are rendered is controlled by
the end user.  For instance, some users may prefer visual feedback
such as a horizontal progress bar in the terminal, whereas others may
prefer auditory feedback.</p>
<img src="imgs/three_in_chinese.gif" alt="Three strokes writing three in Chinese" style="float: right; margin-right: 1ex; margin-left: 1ex;"/>
<p>Design motto:</p>
<blockquote>
<div><p>The developer is responsible for providing progress updates but it’s
only the end user who decides if, when, and how progress should be
presented. No exceptions will be allowed.</p>
</div></blockquote>
<section id="two-minimal-apis-one-for-developers-and-one-for-end-users">
<h1>Two Minimal APIs - One For Developers and One For End-Users<a class="headerlink" href="#two-minimal-apis-one-for-developers-and-one-for-end-users" title="Link to this heading">#</a></h1>
<div style="overflow: hidden">
<div style="float: left">
<table style="border: 1px solid #999; box-shadow: 2px 2px 2px #999;">
<tr><th>Developer's API</th></tr>
<tr style="vertical-align: top">
<td>
<p>
1. Set up a progressor with a certain number of steps:
</p>
<pre>
p &lt;- progressor(nsteps)
p &lt;- progressor(along = x)
</pre>
<p>
2. Signal progress:
</p>
<pre>
p()               # one-step progress
p(amount = 0)     # "still alive"
p("loading ...")  # pass on a message
</pre>
</td>
</tr>
</table>
</div>
<div style="float: left">&nbsp;&nbsp;&nbsp;&nbsp;</div>
<div style="float: left">
<table style="border: 1px solid #999; box-shadow: 2px 2px 2px #999;">
<tr><th>End-user's API</th></tr>
<tr style="vertical-align: top">
<td>
<p>
1a. Subscribe to progress updates from everywhere:
</p>
<pre>
handlers(global = TRUE)

y &lt;- slow_sum(1:5)
y &lt;- slow_sum(6:10)
</pre>
<p>
1b. Subscribe to a specific expression:
</p>
<pre>
with_progress({
  y &lt;- slow_sum(1:5)
  y &lt;- slow_sum(6:10)
})
</pre>
<p>
2. Configure how progress is presented:
</p>
<pre>
handlers("progress")
handlers("txtprogressbar", "beepr")
handlers(handler_pbcol(enable_after = 3.0))
handlers(handler_progress(complete = "#"))
</pre>
</td>
</table>
</div>
</div>
</section>
<section id="a-simple-example">
<h1>A simple example<a class="headerlink" href="#a-simple-example" title="Link to this heading">#</a></h1>
<p>Assume that we have a function <code class="docutils literal notranslate"><span class="pre">slow_sum()</span></code> for adding up the values
in a vector.  It is so slow, that we like to provide progress updates
to whoever might be interested in it.  With the <strong>progressr</strong> package,
this can be done as:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">slow_sum</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">progressr</span><span class="o">::</span><span class="nf">progressor</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">  </span><span class="n">sum</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span>
<span class="w">  </span><span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="n">kk</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nf">seq_along</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">0.1</span><span class="p">)</span>
<span class="w">    </span><span class="n">sum</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span>
<span class="w">    </span><span class="nf">p</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Adding %g&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">sum</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note how there are <em>no</em> arguments in the code that specifies how
progress is presented.  The only task for the developer is to decide
on where in the code it makes sense to signal that progress has been
made.  As we will see next, it is up to the end user of this code to
decide whether they want to receive progress updates or not, and, if
so, in what format.</p>
<section id="without-reporting-on-progress">
<h2>Without reporting on progress<a class="headerlink" href="#without-reporting-on-progress" title="Link to this heading">#</a></h2>
<p>When calling this function as in:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">slow_sum</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">)</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">y</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="m">55</span>
<span class="o">&gt;</span>
</pre></div>
</div>
<p>it will behave as any function and there will be no progress
updates displayed.</p>
</section>
<section id="reporting-on-progress">
<h2>Reporting on progress<a class="headerlink" href="#reporting-on-progress" title="Link to this heading">#</a></h2>
<p>If we are only interested in progress for a particular call, we can
do:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="nf">library</span><span class="p">(</span><span class="n">progressr</span><span class="p">)</span>
<span class="o">&gt;</span><span class="w"> </span><span class="nf">with_progress</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">slow_sum</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">))</span>
<span class="w">  </span><span class="o">|====================</span><span class="w">                               </span><span class="o">|</span><span class="w">  </span><span class="m">40</span>%
</pre></div>
</div>
<p>However, if we want to report on progress from <em>every</em> call, wrapping
the calls in <code class="docutils literal notranslate"><span class="pre">with_progress()</span></code> might become too cumbersome.  If so, we
can enable the global progress handler:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="nf">library</span><span class="p">(</span><span class="n">progressr</span><span class="p">)</span>
<span class="o">&gt;</span><span class="w"> </span><span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<p>so that progress updates are reported on wherever signaled, e.g.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">slow_sum</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">)</span>
<span class="w">  </span><span class="o">|====================</span><span class="w">                               </span><span class="o">|</span><span class="w">  </span><span class="m">40</span><span class="o">%</span>
<span class="o">&gt; y &lt;- slow_sum(10:1)</span>
<span class="o">  |========================================           |  80%</span>
</pre></div>
</div>
<p>This requires R 4.0.0 or newer.  To disable this again, do:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
<p>In the below examples, we will assume <code class="docutils literal notranslate"><span class="pre">handlers(global</span> <span class="pre">=</span> <span class="pre">TRUE)</span></code> is
already set.</p>
</section>
</section>
<section id="customizing-how-progress-is-reported">
<h1>Customizing how progress is reported<a class="headerlink" href="#customizing-how-progress-is-reported" title="Link to this heading">#</a></h1>
<section id="terminal-based-progress-bars">
<h2>Terminal-based progress bars<a class="headerlink" href="#terminal-based-progress-bars" title="Link to this heading">#</a></h2>
<p>The default is to present progress via <code class="docutils literal notranslate"><span class="pre">utils::txtProgressBar()</span></code>,
which is available on all R installations.  It presents itself as an
ASCII-based horizontal progress bar in the R terminal. This is
rendered as:</p>
<p><img alt="SVG animation of the default &quot;txtprogressbar&quot; progress handler" src="renv/library/windows/R-4.4/x86_64-w64-mingw32/progressr/doc/imgs/handler_txtprogressbar-default.svg" /></p>
<p>We can tweak this “txtprogressbar” handler to use red hearts for the
bar, e.g.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">handlers</span><span class="p">(</span><span class="nf">handler_txtprogressbar</span><span class="p">(</span><span class="n">char</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cli</span><span class="o">::</span><span class="nf">col_red</span><span class="p">(</span><span class="n">cli</span><span class="o">::</span><span class="n">symbol</span><span class="o">$</span><span class="n">heart</span><span class="p">)))</span>
</pre></div>
</div>
<p>which results in:</p>
<p><img alt="SVG animation of the &quot;txtprogressbar&quot; progress handler with red hearts" src="renv/library/windows/R-4.4/x86_64-w64-mingw32/progressr/doc/imgs/handler_txtprogressbar-char-ansi.svg" /></p>
<p>Another example is:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">handlers</span><span class="p">(</span><span class="nf">handler_pbcol</span><span class="p">(</span>
<span class="w">      </span><span class="n">adjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.0</span><span class="p">,</span>
<span class="w">    </span><span class="n">complete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">cli</span><span class="o">::</span><span class="nf">bg_red</span><span class="p">(</span><span class="n">cli</span><span class="o">::</span><span class="nf">col_black</span><span class="p">(</span><span class="n">s</span><span class="p">)),</span>
<span class="w">  </span><span class="n">incomplete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">cli</span><span class="o">::</span><span class="nf">bg_cyan</span><span class="p">(</span><span class="n">cli</span><span class="o">::</span><span class="nf">col_black</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="p">))</span>
</pre></div>
</div>
<p>which results in:</p>
<p><img alt="SVG animation of the &quot;pbcol&quot; progress handler with text aligned to the right" src="renv/library/windows/R-4.4/x86_64-w64-mingw32/progressr/doc/imgs/handler_pbcol-adjust-right-complete.svg" /></p>
<p>To change the default, to, say, <code class="docutils literal notranslate"><span class="pre">cli_progress_bar()</span></code> by the <strong><a class="reference external" href="https://cran.r-project.org/package=cli">cli</a></strong>
package, set:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">handlers</span><span class="p">(</span><span class="s">&quot;cli&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This progress handler will present itself as:</p>
<p><img alt="SVG animation of the default &quot;cli&quot; progress handler" src="renv/library/windows/R-4.4/x86_64-w64-mingw32/progressr/doc/imgs/handler_cli-default.svg" /></p>
<p>To instead use <code class="docutils literal notranslate"><span class="pre">progress_bar()</span></code> by the <strong><a class="reference external" href="https://cran.r-project.org/package=progress">progress</a></strong> package, set:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">handlers</span><span class="p">(</span><span class="s">&quot;progress&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This progress handler will present itself as:</p>
<p><img alt="SVG animation of the default &quot;progress&quot; progress handler" src="renv/library/windows/R-4.4/x86_64-w64-mingw32/progressr/doc/imgs/handler_progress-default.svg" /></p>
<p>To set the default progress handler, or handlers, in all your R
sessions, call <code class="docutils literal notranslate"><span class="pre">progressr::handlers(...)</span></code> in your
<code>~/.Rprofile</code> startup file.</p>
</section>
<section id="auditory-progress-updates">
<h2>Auditory progress updates<a class="headerlink" href="#auditory-progress-updates" title="Link to this heading">#</a></h2>
<p>Progress updates do not have to be presented visually. They can
equally well be communicated via audio. For example, using:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">handlers</span><span class="p">(</span><span class="s">&quot;beepr&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>will present itself as sounds played at the beginning, while progressing, and at the end (using different <strong><a class="reference external" href="https://cran.r-project.org/package=beepr">beepr</a></strong> sounds).  There will be <em>no</em> output written to the terminal;</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">slow_sum</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">)</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">y</span>
<span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="m">55</span>
<span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="concurrent-auditory-and-visual-progress-updates">
<h2>Concurrent auditory and visual progress updates<a class="headerlink" href="#concurrent-auditory-and-visual-progress-updates" title="Link to this heading">#</a></h2>
<p>It is possible to have multiple progress handlers presenting progress
updates at the same time.  For example, to get both visual and
auditory updates, use:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">handlers</span><span class="p">(</span><span class="s">&quot;txtprogressbar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;beepr&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="silence-all-progress">
<h2>Silence all progress<a class="headerlink" href="#silence-all-progress" title="Link to this heading">#</a></h2>
<p>To silence all progress updates, use:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">handlers</span><span class="p">(</span><span class="s">&quot;void&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="further-configuration-of-progress-handlers">
<h2>Further configuration of progress handlers<a class="headerlink" href="#further-configuration-of-progress-handlers" title="Link to this heading">#</a></h2>
<p>Above we have seen examples where the <code class="docutils literal notranslate"><span class="pre">handlers()</span></code> takes one or more
strings as input, e.g. <code class="docutils literal notranslate"><span class="pre">handlers(c(&quot;progress&quot;,</span> <span class="pre">&quot;beepr&quot;))</span></code>.  This is
short for a more flexible specification where we can pass a list of
handler functions, e.g.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">handlers</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span>
<span class="w">  </span><span class="nf">handler_progress</span><span class="p">(),</span>
<span class="w">  </span><span class="nf">handler_beepr</span><span class="p">()</span>
<span class="p">))</span>
</pre></div>
</div>
<p>With this construct, we can make adjustments to the default behavior
of these progress handlers.  For example, we can configure the
<code class="docutils literal notranslate"><span class="pre">format</span></code>, <code class="docutils literal notranslate"><span class="pre">width</span></code>, and <code class="docutils literal notranslate"><span class="pre">complete</span></code> arguments of
<code class="docutils literal notranslate"><span class="pre">progress::progress_bar$new()</span></code>, and tell <strong>beepr</strong> to use a different
<code class="docutils literal notranslate"><span class="pre">finish</span></code> sound and generate sounds at most every two seconds by
setting:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">handlers</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span>
<span class="w">  </span><span class="nf">handler_progress</span><span class="p">(</span>
<span class="w">    </span><span class="n">format</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;:spin :current/:total (:message) [:bar] :percent in :elapsed ETA: :eta&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">width</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="m">60</span><span class="p">,</span>
<span class="w">    </span><span class="n">complete</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;+&quot;</span>
<span class="w">  </span><span class="p">),</span>
<span class="w">  </span><span class="nf">handler_beepr</span><span class="p">(</span>
<span class="w">    </span><span class="n">finish</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;wilhelm&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.0</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">))</span>
</pre></div>
</div>
</section>
</section>
<section id="sticky-messages">
<h1>Sticky messages<a class="headerlink" href="#sticky-messages" title="Link to this heading">#</a></h1>
<p>As seen above, some progress handlers present the progress message as
part of its output, e.g. the “progress” handler will display the
message as part of the progress bar.  It is also possible to “push”
the message up together with other terminal output.  This can be done
by adding class attribute <code class="docutils literal notranslate"><span class="pre">&quot;sticky&quot;</span></code> to the progression signaled.
This works for several progress handlers that output to the terminal.
For example, with:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">slow_sum</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">progressr</span><span class="o">::</span><span class="nf">progressor</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">  </span><span class="n">sum</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0</span>
<span class="w">  </span><span class="kr">for</span><span class="w"> </span><span class="p">(</span><span class="n">kk</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nf">seq_along</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">0.1</span><span class="p">)</span>
<span class="w">    </span><span class="n">sum</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sum</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span>
<span class="w">    </span><span class="nf">p</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Step %d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">kk</span><span class="p">),</span><span class="w"> </span><span class="n">class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">kk</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;sticky&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="w">    </span><span class="nf">p</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Adding %g&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">sum</span>
<span class="p">}</span>
</pre></div>
</div>
<p>we get</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="nf">handlers</span><span class="p">(</span><span class="s">&quot;txtprogressbar&quot;</span><span class="p">)</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">slow_sum</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">30</span><span class="p">)</span>
<span class="n">Step</span><span class="w"> </span><span class="m">5</span>
<span class="n">Step</span><span class="w"> </span><span class="m">10</span>
<span class="w">  </span><span class="o">|====================</span><span class="w">                               </span><span class="o">|</span><span class="w">  </span><span class="m">43</span>%
</pre></div>
</div>
<p>and</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="nf">handlers</span><span class="p">(</span><span class="s">&quot;progress&quot;</span><span class="p">)</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">slow_sum</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">30</span><span class="p">)</span>
<span class="n">Step</span><span class="w"> </span><span class="m">5</span>
<span class="n">Step</span><span class="w"> </span><span class="m">10</span>
<span class="o">/</span><span class="w"> </span><span class="p">[</span><span class="o">===============&gt;-------------------------</span><span class="p">]</span><span class="w">  </span><span class="m">43</span>%<span class="w"> </span><span class="n">Adding</span><span class="w"> </span><span class="m">13</span>
</pre></div>
</div>
</section>
<section id="use-regular-output-as-usual-alongside-progress-updates">
<h1>Use regular output as usual alongside progress updates<a class="headerlink" href="#use-regular-output-as-usual-alongside-progress-updates" title="Link to this heading">#</a></h1>
<p>In contrast to other progress-bar frameworks, output from <code class="docutils literal notranslate"><span class="pre">message()</span></code>,
<code class="docutils literal notranslate"><span class="pre">cat()</span></code>, <code class="docutils literal notranslate"><span class="pre">print()</span></code> and so on, will <em>not</em> interfere with progress
reported via <strong>progressr</strong>.  For example, say we have:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">slow_sqrt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">progressor</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span>
<span class="w">  </span><span class="nf">lapply</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">message</span><span class="p">(</span><span class="s">&quot;Calculating the square root of &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">2</span><span class="p">)</span>
<span class="w">    </span><span class="nf">p</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;x=%g&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">}</span>
</pre></div>
</div>
<p>we will get:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="nf">library</span><span class="p">(</span><span class="n">progressr</span><span class="p">)</span>
<span class="o">&gt;</span><span class="w"> </span><span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="o">&gt;</span><span class="w"> </span><span class="nf">handlers</span><span class="p">(</span><span class="s">&quot;progress&quot;</span><span class="p">)</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">slow_sqrt</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">8</span><span class="p">)</span>
<span class="n">Calculating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">square</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="m">1</span>
<span class="n">Calculating</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">square</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="m">2</span>
<span class="o">-</span><span class="w"> </span><span class="p">[</span><span class="o">===========&gt;-----------------------------------</span><span class="p">]</span><span class="w">  </span><span class="m">25</span>%<span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="m">2</span>
</pre></div>
</div>
<p>This works because <strong>progressr</strong> will briefly buffer any output
internally and only release it when the next progress update is
received just before the progress is re-rendered in the terminal.
This is why you see a two second delay when running the above example.
Note that, if we use progress handlers that do not output to the
terminal, such as <code class="docutils literal notranslate"><span class="pre">handlers(&quot;beepr&quot;)</span></code>, then output does not have to be
buffered and will appear immediately.</p>
<p><em>Comment</em>: When signaling a warning using <code class="docutils literal notranslate"><span class="pre">warning(msg,</span> <span class="pre">immediate.</span> <span class="pre">=</span> <span class="pre">TRUE)</span></code> the message is immediately outputted to the standard-error
stream.  However, this is not possible to emulate when warnings are
intercepted using calling handlers, which are used by
<code class="docutils literal notranslate"><span class="pre">with_progress()</span></code>.  This is a limitation of R that cannot be worked
around.  Because of this, the above call will behave the same as
<code class="docutils literal notranslate"><span class="pre">warning(msg)</span></code> - that is, all warnings will be buffered by R
internally and released only when all computations are done.</p>
</section>
<section id="support-for-progressr-elsewhere">
<h1>Support for progressr elsewhere<a class="headerlink" href="#support-for-progressr-elsewhere" title="Link to this heading">#</a></h1>
<p>Note that progression updates by <strong>progressr</strong> is designed to work out
of the box for any iterator framework in R.  Below is an set of
examples for the most common ones.</p>
<section id="base-r-apply-functions">
<h2>Base R Apply Functions<a class="headerlink" href="#base-r-apply-functions" title="Link to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">progressr</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">my_fcn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">progressor</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span>
<span class="w">  </span><span class="nf">lapply</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">0.1</span><span class="p">)</span>
<span class="w">    </span><span class="nf">p</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;x=%g&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">}</span>

<span class="nf">my_fcn</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">)</span>
<span class="c1">#  |====================                               |  40%</span>
</pre></div>
</div>
</section>
<section id="the-foreach-package">
<h2>The foreach package<a class="headerlink" href="#the-foreach-package" title="Link to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">foreach</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">progressr</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">my_fcn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">progressor</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span>
<span class="w">  </span><span class="nf">foreach</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">%do%</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">0.1</span><span class="p">)</span>
<span class="w">    </span><span class="nf">p</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;x=%g&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="nf">my_fcn</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">)</span>
<span class="c1">#  |====================                               |  40%</span>
</pre></div>
</div>
</section>
<section id="the-purrr-package">
<h2>The purrr package<a class="headerlink" href="#the-purrr-package" title="Link to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">purrr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">progressr</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">my_fcn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">progressor</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span>
<span class="w">  </span><span class="nf">map</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">0.1</span><span class="p">)</span>
<span class="w">    </span><span class="nf">p</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;x=%g&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">}</span>

<span class="nf">my_fcn</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">)</span>
<span class="c1">#  |====================                               |  40%</span>
</pre></div>
</div>
</section>
<section id="the-plyr-package">
<h2>The plyr package<a class="headerlink" href="#the-plyr-package" title="Link to this heading">#</a></h2>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">plyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">progressr</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">my_fcn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">progressor</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span>
<span class="w">  </span><span class="nf">llply</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kc">...</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">0.1</span><span class="p">)</span>
<span class="w">    </span><span class="nf">p</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;x=%g&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">}</span>

<span class="nf">my_fcn</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">)</span>
<span class="c1">#  |====================                               |  40%</span>
</pre></div>
</div>
<p>Note how this solution does not make use of <strong>plyr</strong>’s <code class="docutils literal notranslate"><span class="pre">.progress</span></code>
argument, because the above solution is more powerful and more
flexible, e.g. we have more control on progress updates and their
messages.  However, if you prefer the traditional <strong>plyr</strong> approach,
you can use <code class="docutils literal notranslate"><span class="pre">.progress</span> <span class="pre">=</span> <span class="pre">&quot;progressr&quot;</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">&lt;-</span> <span class="pre">llply(...,</span> <span class="pre">.progress</span> <span class="pre">=</span> <span class="pre">&quot;progressr&quot;)</span></code>.</p>
</section>
<section id="the-knitr-package">
<h2>The knitr package<a class="headerlink" href="#the-knitr-package" title="Link to this heading">#</a></h2>
<p>When compiling (“knitting”) an knitr-based vignette, for instance, via
<code class="docutils literal notranslate"><span class="pre">knitr::knit()</span></code>, <strong><a class="reference external" href="https://cran.r-project.org/package=knitr">knitr</a></strong> shows the progress of code chunks
processed thus far using a progress bar.  In <strong>knitr</strong> (&gt;= 1.42) [to
be released as of 2022-12-12], we can use <strong>progressr</strong> for this
progress reporting.  To do this, set R option <code class="docutils literal notranslate"><span class="pre">knitr.progress.fun</span></code> as:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">options</span><span class="p">(</span><span class="n">knitr.progress.fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">total</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">progressr</span><span class="o">::</span><span class="nf">progressor</span><span class="p">(</span><span class="n">total</span><span class="p">,</span><span class="w"> </span><span class="n">on_exit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">  </span><span class="nf">list</span><span class="p">(</span>
<span class="w">    </span><span class="n">update</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="nf">p</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;chunk: %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span>
<span class="w">    </span><span class="n">done</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="p">()</span><span class="w"> </span><span class="nf">p</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;finish&quot;</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
<p>This configures <strong>knitr</strong> to signal progress via the <strong>progressr</strong>
framework.  To report on these, use:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">progressr</span><span class="o">::</span><span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="replace-any-cli-progress-bars-with-progressr-updates">
<h2>Replace any cli progress bars with progressr updates<a class="headerlink" href="#replace-any-cli-progress-bars-with-progressr-updates" title="Link to this heading">#</a></h2>
<p>The <strong>cli</strong> package is used for progress reporting by many several
packages, notably tidyverse packages.  For instance, in <strong>purrr</strong>, you
can do:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">purrr</span><span class="o">::</span><span class="nf">map</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">100</span><span class="p">,</span><span class="w"> </span>\<span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">0.1</span><span class="p">),</span><span class="w"> </span><span class="n">.progress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
<p>to report on progress via the <strong>cli</strong> package as <code class="docutils literal notranslate"><span class="pre">map()</span></code> is iterating
over the elements.  Now, instead of using the default, built-in
<strong>cli</strong> progress bar, we can customize <strong>cli</strong> to report on progress
via <strong>progressr</strong> instead.  To do this, set R option
<code class="docutils literal notranslate"><span class="pre">cli.progress_handlers</span></code> as:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">options</span><span class="p">(</span><span class="n">cli.progress_handlers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;progressr&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>With this option set, <strong>cli</strong> will now report on progress according to
your <code class="docutils literal notranslate"><span class="pre">progressr::handlers()</span></code> settings.  For example, with:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">progressr</span><span class="o">::</span><span class="nf">handlers</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;beepr&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;rstudio&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>will report on progress using <strong>beepr</strong> and the RStudio Console
progress panel.</p>
<p>To make <strong>cli</strong> report via <strong>progressr</strong> in all your R session, set
the above R option in your <code>~/.Rprofile</code> startup file.</p>
<p><em>Note:</em> A <strong>cli</strong> progress bar can have a “name”, which can be
specfied in <strong>purrr</strong> function via argument <code class="docutils literal notranslate"><span class="pre">.progress</span></code>,
e.g. <code class="docutils literal notranslate"><span class="pre">.progress</span> <span class="pre">=</span> <span class="pre">&quot;processing&quot;</span></code>.  This name is then displayed in front
of the progress bar.  However, because the <strong>progressr</strong> framework
does not have a concept of progress “name”, they are silently ignored
when using <code class="docutils literal notranslate"><span class="pre">options(cli.progress_handlers</span> <span class="pre">=</span> <span class="pre">&quot;progressr&quot;)</span></code>.</p>
</section>
</section>
<section id="parallel-processing-and-progress-updates">
<h1>Parallel processing and progress updates<a class="headerlink" href="#parallel-processing-and-progress-updates" title="Link to this heading">#</a></h1>
<p>The <strong><a class="reference external" href="https://cran.r-project.org/package=future">future</a></strong> framework, which provides a unified API for parallel
and distributed processing in R, has built-in support for the kind of
progression updates produced by the <strong>progressr</strong> package.  This means
that you can use it with for instance <strong><a class="reference external" href="https://cran.r-project.org/package=future.apply">future.apply</a></strong>, <strong><a class="reference external" href="https://cran.r-project.org/package=furrr">furrr</a></strong>,
and <strong><a class="reference external" href="https://cran.r-project.org/package=foreach">foreach</a></strong> with <strong><a class="reference external" href="https://cran.r-project.org/package=doFuture">doFuture</a></strong>, and <strong><a class="reference external" href="https://cran.r-project.org/package=plyr">plyr</a></strong> or
<strong><a class="reference external" href="https://www.bioconductor.org/packages/BiocParallel/">BiocParallel</a></strong> with <strong>doFuture</strong>.  In contrast, <em>non-future</em>
parallelization methods such as <strong>parallel</strong>’s <code class="docutils literal notranslate"><span class="pre">mclapply()</span></code> and,
<code class="docutils literal notranslate"><span class="pre">parallel::parLapply()</span></code>, and <strong>foreach</strong> adapters like <strong>doParallel</strong>
do <em>not</em> support progress reports via <strong>progressr</strong>.</p>
<section id="future-lapply-parallel-lapply">
<h2>future_lapply() - parallel lapply()<a class="headerlink" href="#future-lapply-parallel-lapply" title="Link to this heading">#</a></h2>
<p>Here is an example that uses <code class="docutils literal notranslate"><span class="pre">future_lapply()</span></code> of the <strong><a class="reference external" href="https://cran.r-project.org/package=future.apply">future.apply</a></strong> package to parallelize on the local machine while at the same time signaling progression updates:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">future.apply</span><span class="p">)</span>
<span class="nf">plan</span><span class="p">(</span><span class="n">multisession</span><span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">progressr</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="s">&quot;progress&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;beepr&quot;</span><span class="p">)</span>

<span class="n">my_fcn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">progressor</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span>
<span class="w">  </span><span class="nf">future_lapply</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kc">...</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">6.0</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="nf">p</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;x=%g&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">}</span>

<span class="nf">my_fcn</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">)</span>
<span class="c1"># / [================&gt;-----------------------------]  40% x=2</span>
</pre></div>
</div>
</section>
<section id="foreach-with-dofuture">
<h2>foreach() with doFuture<a class="headerlink" href="#foreach-with-dofuture" title="Link to this heading">#</a></h2>
<p>Here is an example that uses <code class="docutils literal notranslate"><span class="pre">foreach()</span></code> of the <strong><a class="reference external" href="https://cran.r-project.org/package=foreach">foreach</a></strong> package
together with <code class="docutils literal notranslate"><span class="pre">%dofuture%</span></code> of the <strong><a class="reference external" href="https://cran.r-project.org/package=doFuture">doFuture</a></strong> package to
parallelize while reporting on progress.  This example parallelizes on
the local machine, it works alsof for remote machines:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">doFuture</span><span class="p">)</span><span class="w">    </span><span class="c1">## %dofuture%</span>
<span class="nf">plan</span><span class="p">(</span><span class="n">multisession</span><span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">progressr</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="s">&quot;progress&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;beepr&quot;</span><span class="p">)</span>

<span class="n">my_fcn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">progressor</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span>
<span class="w">  </span><span class="nf">foreach</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">%dofuture%</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">6.0</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="nf">p</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;x=%g&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="nf">my_fcn</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">)</span>
<span class="c1"># / [================&gt;-----------------------------]  40% x=2</span>
</pre></div>
</div>
<p>For existing code using the traditional <code class="docutils literal notranslate"><span class="pre">%dopar%</span></code> operators of the
<strong><a class="reference external" href="https://cran.r-project.org/package=foreach">foreach</a></strong> package, we can register the <strong><a class="reference external" href="https://cran.r-project.org/package=doFuture">doFuture</a></strong> adaptor and
use the same <strong>progressr</strong> as above to progress updates;</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">doFuture</span><span class="p">)</span>
<span class="nf">registerDoFuture</span><span class="p">()</span><span class="w">      </span><span class="c1">## %dopar% parallelizes via future</span>
<span class="nf">plan</span><span class="p">(</span><span class="n">multisession</span><span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">progressr</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="s">&quot;progress&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;beepr&quot;</span><span class="p">)</span>

<span class="n">my_fcn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">progressor</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span>
<span class="w">  </span><span class="nf">foreach</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="o">%dopar%</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">6.0</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="nf">p</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;x=%g&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="nf">my_fcn</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">)</span>
<span class="c1"># / [================&gt;-----------------------------]  40% x=2</span>
</pre></div>
</div>
</section>
<section id="future-map-parallel-purrr-map">
<h2>future_map() - parallel purrr::map()<a class="headerlink" href="#future-map-parallel-purrr-map" title="Link to this heading">#</a></h2>
<p>Here is an example that uses <code class="docutils literal notranslate"><span class="pre">future_map()</span></code> of the <strong><a class="reference external" href="https://cran.r-project.org/package=furrr">furrr</a></strong> package
to parallelize on the local machine while at the same time signaling
progression updates:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">furrr</span><span class="p">)</span>
<span class="nf">plan</span><span class="p">(</span><span class="n">multisession</span><span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">progressr</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="s">&quot;progress&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;beepr&quot;</span><span class="p">)</span>

<span class="n">my_fcn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">progressor</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span>
<span class="w">  </span><span class="nf">future_map</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">6.0</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="nf">p</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;x=%g&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">}</span>

<span class="nf">my_fcn</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">)</span>
<span class="c1"># / [================&gt;-----------------------------]  40% x=2</span>
</pre></div>
</div>
<p><em>Note:</em> This solution does not involved the <code class="docutils literal notranslate"><span class="pre">.progress</span> <span class="pre">=</span> <span class="pre">TRUE</span></code>
argument that <strong>furrr</strong> implements.  Because <strong>progressr</strong> is more
generic and because <code class="docutils literal notranslate"><span class="pre">.progress</span> <span class="pre">=</span> <span class="pre">TRUE</span></code> only supports certain future
backends and produces errors on non-supported backends, I recommended
to stop using <code class="docutils literal notranslate"><span class="pre">.progress</span> <span class="pre">=</span> <span class="pre">TRUE</span></code> and use the <strong>progressr</strong> package
instead.</p>
</section>
<section id="biocparallel-bplapply-parallel-lapply">
<h2>BiocParallel::bplapply() - parallel lapply()<a class="headerlink" href="#biocparallel-bplapply-parallel-lapply" title="Link to this heading">#</a></h2>
<p>Here is an example that uses <code class="docutils literal notranslate"><span class="pre">bplapply()</span></code> of the <strong><a class="reference external" href="https://www.bioconductor.org/packages/BiocParallel/">BiocParallel</a></strong>
package to parallelize on the local machine while at the same time
signaling progression updates:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">BiocParallel</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">doFuture</span><span class="p">)</span>
<span class="nf">register</span><span class="p">(</span><span class="nf">DoparParam</span><span class="p">())</span><span class="w">  </span><span class="c1">## BiocParallel parallelizes via %dopar%</span>
<span class="nf">registerDoFuture</span><span class="p">()</span><span class="w">      </span><span class="c1">## %dopar% parallelizes via future</span>
<span class="nf">plan</span><span class="p">(</span><span class="n">multisession</span><span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">progressr</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="s">&quot;progress&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;beepr&quot;</span><span class="p">)</span>

<span class="n">my_fcn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">progressor</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span>
<span class="w">  </span><span class="nf">bplapply</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">6.0</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="nf">p</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;x=%g&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">}</span>

<span class="nf">my_fcn</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">)</span>
<span class="c1"># / [================&gt;-----------------------------]  40% x=2</span>
</pre></div>
</div>
</section>
<section id="plyr-llply-parallel-true-with-dofuture">
<h2>plyr::llply(…, .parallel = TRUE) with doFuture<a class="headerlink" href="#plyr-llply-parallel-true-with-dofuture" title="Link to this heading">#</a></h2>
<p>Here is an example that uses <code class="docutils literal notranslate"><span class="pre">llply()</span></code> of the <strong><a class="reference external" href="https://cran.r-project.org/package=plyr">plyr</a></strong> package to
parallelize on the local machine while at the same time signaling
progression updates:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">plyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">doFuture</span><span class="p">)</span>
<span class="nf">registerDoFuture</span><span class="p">()</span><span class="w">      </span><span class="c1">## %dopar% parallelizes via future</span>
<span class="nf">plan</span><span class="p">(</span><span class="n">multisession</span><span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">progressr</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="s">&quot;progress&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;beepr&quot;</span><span class="p">)</span>

<span class="n">my_fcn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">progressor</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span>
<span class="w">  </span><span class="nf">llply</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kc">...</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">6.0</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="w">    </span><span class="nf">p</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;x=%g&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">  </span><span class="p">},</span><span class="w"> </span><span class="n">.parallel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">my_fcn</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">5</span><span class="p">)</span>
<span class="c1"># / [================&gt;-----------------------------]  40% x=2</span>
</pre></div>
</div>
<p><em>Note:</em> As an alternative to the above, recommended approach, one can
use <code class="docutils literal notranslate"><span class="pre">.progress</span> <span class="pre">=</span> <span class="pre">&quot;progressr&quot;</span></code> together with <code class="docutils literal notranslate"><span class="pre">.parallel</span> <span class="pre">=</span> <span class="pre">TRUE</span></code>.  This
requires <strong>plyr</strong> (&gt;= 1.8.7).</p>
</section>
<section id="near-live-versus-buffered-progress-updates-with-futures">
<h2>Near-live versus buffered progress updates with futures<a class="headerlink" href="#near-live-versus-buffered-progress-updates-with-futures" title="Link to this heading">#</a></h2>
<p>As of November 2020, there are four types of <strong>future</strong> backends that are known(*) to provide near-live progress updates:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sequential</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">multicore</span></code>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">multisession</span></code>, and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cluster</span></code> (local and remote)</p></li>
</ol>
<p>Here “near-live” means that the progress handlers will report on
progress almost immediately when the progress is signaled on the
worker.  For all other future backends, the progress updates are only
relayed back to the main machine and reported together with the
results of the futures.  For instance, if <code class="docutils literal notranslate"><span class="pre">future_lapply(X,</span> <span class="pre">FUN)</span></code>
chunks up the processing of, say, 100 elements in <code class="docutils literal notranslate"><span class="pre">X</span></code> into eight
futures, we will see progress from each of the 100 elements as they
are done when using a future backend supporting “near-live” updates,
whereas we will only see those updated to be flushed eight times when
using any other types of future backends.</p>
<p>(*) Other future backends may gain support for “near-live” progress
updating later.  Adding support for those is independent of the
<strong>progressr</strong> package.  Feature requests for adding that support
should go to those future-backend packages.</p>
</section>
</section>
<section id="note-of-caution-sending-progress-updates-too-frequently">
<h1>Note of caution - sending progress updates too frequently<a class="headerlink" href="#note-of-caution-sending-progress-updates-too-frequently" title="Link to this heading">#</a></h1>
<p>Signaling progress updates comes with some overhead.  In situation
where we use progress updates, this overhead is typically much smaller
than the task we are processing in each step.  However, if the task we
iterate over is quick, then the extra time induced by the progress
updates might end up dominating the overall processing time.  If that
is the case, a simple solution is to only signal progress updates
every n:th step.  Here is a version of <code class="docutils literal notranslate"><span class="pre">slow_sum()</span></code> that signals
progress every 10:th iteration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">slow_sum</span> <span class="o">&lt;-</span> <span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">p</span> <span class="o">&lt;-</span> <span class="n">progressr</span><span class="p">::</span><span class="n">progressor</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span>
  <span class="nb">sum</span> <span class="o">&lt;-</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">kk</span> <span class="ow">in</span> <span class="n">seq_along</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">Sys</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="nb">sum</span> <span class="o">&lt;-</span> <span class="nb">sum</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">kk</span> <span class="o">%%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">p</span><span class="p">(</span><span class="n">message</span> <span class="o">=</span> <span class="n">sprintf</span><span class="p">(</span><span class="s2">&quot;Adding </span><span class="si">%g</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">kk</span><span class="p">]))</span>
  <span class="p">}</span>
  <span class="nb">sum</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The overhead of progress signaling may depend on context.  For
example, in parallel processing with near-live progress updates via
‘multisession’ futures, each progress update is communicated via a
socket connections back to the main R session.  These connections
might become clogged up if progress updates are too frequent.</p>
</section>
<section id="progress-updates-in-non-interactive-mode-batch-mode">
<h1>Progress updates in non-interactive mode (“batch mode”)<a class="headerlink" href="#progress-updates-in-non-interactive-mode-batch-mode" title="Link to this heading">#</a></h1>
<p>When running R from the command line, R runs in a non-interactive mode
(<code class="docutils literal notranslate"><span class="pre">interactive()</span></code> returns <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>).  The default behavior of
<strong>progressr</strong> is to <em>not</em> report on progress in non-interactive mode.
To reported on progress also then, set R options <code class="docutils literal notranslate"><span class="pre">progressr.enable</span></code> or
environment variable <code class="docutils literal notranslate"><span class="pre">R_PROGRESSR_ENABLE</span></code> to <code class="docutils literal notranslate"><span class="pre">TRUE</span></code>.  For example,</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>Rscript<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;library(progressr)&quot;</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;with_progress(y &lt;- slow_sum(1:10))&quot;</span>
</pre></div>
</div>
<p>will <em>not</em> report on progress, whereas</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">R_PROGRESSR_ENABLE</span><span class="o">=</span>TRUE
$<span class="w"> </span>Rscript<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;library(progressr)&quot;</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;with_progress(y &lt;- slow_sum(1:10))&quot;</span>
</pre></div>
</div>
<p>will.</p>
</section>
<section id="roadmap">
<h1>Roadmap<a class="headerlink" href="#roadmap" title="Link to this heading">#</a></h1>
<p>Because this project is under active development, the progressr API is
currently kept at a very minimum.  This will allow for the framework
and the API to evolve while minimizing the risk for breaking code that
depends on it.  The roadmap for developing the API is roughly:</p>
<ul class="contains-task-list simple">
<li class="task-list-item"><p><input class="task-list-item-checkbox" checked="checked" disabled="disabled" type="checkbox"> Provide minimal API for producing progress updates,
i.e. <code class="docutils literal notranslate"><span class="pre">progressor()</span></code>, <code class="docutils literal notranslate"><span class="pre">with_progress()</span></code>, <code class="docutils literal notranslate"><span class="pre">handlers()</span></code></p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" checked="checked" disabled="disabled" type="checkbox"> Add support for global progress handlers removing the need for
the user having to specify <code class="docutils literal notranslate"><span class="pre">with_progress()</span></code>,
i.e. <code class="docutils literal notranslate"><span class="pre">handlers(global</span> <span class="pre">=</span> <span class="pre">TRUE)</span></code> and <code class="docutils literal notranslate"><span class="pre">handlers(global</span> <span class="pre">=</span> <span class="pre">FALSE)</span></code></p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Make it possible to create a progressor also in the global
environment (see ‘Known issues’ below)</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Add support for nested progress updates</p></li>
<li class="task-list-item"><p><input class="task-list-item-checkbox" disabled="disabled" type="checkbox"> Add API to allow users and package developers to design
additional progression handlers</p></li>
</ul>
<p>For a more up-to-date view on what features might be added, see
<a class="github reference external" href="https://github.com/futureverse/progressr/issues">futureverse/progressr#issues</a>.</p>
</section>
<section id="appendix">
<h1>Appendix<a class="headerlink" href="#appendix" title="Link to this heading">#</a></h1>
<section id="known-issues">
<h2>Known issues<a class="headerlink" href="#known-issues" title="Link to this heading">#</a></h2>
<section id="a-progressor-cannot-be-created-in-the-global-environment">
<h3>A progressor cannot be created in the global environment<a class="headerlink" href="#a-progressor-cannot-be-created-in-the-global-environment" title="Link to this heading">#</a></h3>
<p>It is not possible to create a progressor in the global environment,
e.g. in the the top-level of a script.  It has to be created inside a
function, within <code class="docutils literal notranslate"><span class="pre">with_progress({</span> <span class="pre">...</span> <span class="pre">})</span></code>, <code class="docutils literal notranslate"><span class="pre">local({</span> <span class="pre">...</span> <span class="pre">})</span></code>, or a
similar construct.  For example, the following:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">progressr</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">xs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">5</span>
<span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">progressor</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span>
<span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">0.1</span><span class="p">)</span>
<span class="w">  </span><span class="nf">p</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;x=%g&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span>
<span class="w">  </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
<p>results in an error if tried:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Error</span> <span class="ow">in</span> <span class="n">progressor</span><span class="p">(</span><span class="n">along</span> <span class="o">=</span> <span class="n">xs</span><span class="p">)</span> <span class="p">:</span> 
  <span class="n">A</span> <span class="n">progressor</span> <span class="n">must</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">created</span> <span class="ow">in</span> <span class="n">the</span> <span class="k">global</span> <span class="n">environment</span> <span class="n">unless</span> <span class="n">wrapped</span> <span class="ow">in</span> <span class="n">a</span>
  <span class="n">with_progress</span><span class="p">()</span> <span class="ow">or</span> <span class="n">without_progress</span><span class="p">()</span> <span class="n">call</span><span class="o">.</span> <span class="n">Alternatively</span><span class="p">,</span> <span class="n">create</span> <span class="n">it</span> <span class="n">inside</span> <span class="n">a</span>
  <span class="n">function</span> <span class="ow">or</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">local</span><span class="p">()</span> <span class="n">environment</span> <span class="n">to</span> <span class="n">make</span> <span class="n">sure</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">finite</span> <span class="n">life</span> <span class="n">span</span>
  <span class="n">of</span> <span class="n">the</span> <span class="n">progressor</span>
</pre></div>
</div>
<p>The solution is to wrap it in a <code class="docutils literal notranslate"><span class="pre">local({</span> <span class="pre">...</span> <span class="pre">})</span></code> call, or more
explicitly, in a <code class="docutils literal notranslate"><span class="pre">with_progress({</span> <span class="pre">...</span> <span class="pre">})</span></code> call:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">progressr</span><span class="p">)</span>
<span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">xs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">5</span>
<span class="nf">with_progress</span><span class="p">({</span>
<span class="w">  </span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">progressor</span><span class="p">(</span><span class="n">along</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xs</span><span class="p">)</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lapply</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="w"> </span><span class="kr">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">Sys.sleep</span><span class="p">(</span><span class="m">0.1</span><span class="p">)</span>
<span class="w">    </span><span class="nf">p</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;x=%g&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span>
<span class="w">    </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">  </span><span class="p">})</span>
<span class="p">})</span>
<span class="c1">#  |====================                               |  40%</span>
</pre></div>
</div>
<p>The main reason for this is to limit the life span of each progressor.
If we created it in the global environment, there is a significant
risk it would never finish and block all of the following progressors.</p>
</section>
<section id="the-global-progress-handler-cannot-be-set-everywhere">
<h3>The global progress handler cannot be set everywhere<a class="headerlink" href="#the-global-progress-handler-cannot-be-set-everywhere" title="Link to this heading">#</a></h3>
<p>It is <em>not</em> possible to call <code class="docutils literal notranslate"><span class="pre">handlers(global</span> <span class="pre">=</span> <span class="pre">TRUE)</span></code> in all
circumstances.  For example, it cannot be called within <code class="docutils literal notranslate"><span class="pre">tryCatch()</span></code>
and <code class="docutils literal notranslate"><span class="pre">withCallingHandlers()</span></code>;</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="nf">tryCatch</span><span class="p">(</span><span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">identity</span><span class="p">)</span>
<span class="n">Error</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nf">globalCallingHandlers</span><span class="p">(</span><span class="kc">NULL</span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span>
<span class="w">  </span><span class="n">should</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">called</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">handlers</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">stack</span>
</pre></div>
</div>
<p>This is not a bug - neither in <strong>progressr</strong> nor in R itself. It’s due
to a conservative design on how <em>global</em> calling handlers should work
in R. If it allowed, there’s a risk we might end up getting weird and
unpredictable behaviors when messages, warnings, errors, and other
types of conditions are signaled.</p>
<p>Because <code class="docutils literal notranslate"><span class="pre">tryCatch()</span></code> and <code class="docutils literal notranslate"><span class="pre">withCallingHandlers()</span></code> is used in many
places throughout base R, this means that we also cannot call
<code class="docutils literal notranslate"><span class="pre">handlers(global</span> <span class="pre">=</span> <span class="pre">TRUE)</span></code> as part of a package’s startup process,
e.g. <code class="docutils literal notranslate"><span class="pre">.onLoad()</span></code> or <code class="docutils literal notranslate"><span class="pre">.onAttach()</span></code>.</p>
<p>Another example of this error is if <code class="docutils literal notranslate"><span class="pre">handlers(global</span> <span class="pre">=</span> <span class="pre">TRUE)</span></code> is used
inside package vignettes and dynamic documents such as Rmarkdown.  In
such cases, the global progress handler has to be enabled <em>prior</em> to
processing the document, e.g.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="n">progressr</span><span class="o">::</span><span class="nf">handlers</span><span class="p">(</span><span class="n">global</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">rmarkdown</span><span class="o">::</span><span class="nf">render</span><span class="p">(</span><span class="s">&quot;input.Rmd&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="under-the-hood">
<h2>Under the hood<a class="headerlink" href="#under-the-hood" title="Link to this heading">#</a></h2>
<p>When using the <strong>progressr</strong> package, progression updates are
communicated via R’s condition framework, which provides methods for
creating, signaling, capturing, muffling, and relaying conditions.
Progression updates are of classes <code class="docutils literal notranslate"><span class="pre">progression</span></code> and
<code class="docutils literal notranslate"><span class="pre">immediateCondition</span></code>(*).  The below figure gives an example how
progression conditions are created, signaled, and rendered.</p>
<p>(*) The <code class="docutils literal notranslate"><span class="pre">immediateCondition</span></code> class of conditions are relayed as soon
as possible by the <strong><a class="reference external" href="https://cran.r-project.org/package=future">future</a></strong> framework, which means that
progression updates produced in parallel workers are reported to the
end user as soon as the main R session have received them.</p>
<p><img alt="" src="renv/library/windows/R-4.4/x86_64-w64-mingw32/progressr/doc/imgs/slow_sum.svg" /></p>
<p><em>Figure: Sequence diagram illustrating how signaled progression
conditions are captured by <code class="docutils literal notranslate"><span class="pre">with_progress()</span></code>, or the global
progression handler, and relayed to the two progression handlers
‘progress’ (a progress bar in the terminal) and ‘beepr’ (auditory)
that the end user has chosen.</em></p>
</section>
<section id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Link to this heading">#</a></h2>
<p>To debug progress updates, use:</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span><span class="w"> </span><span class="nf">handlers</span><span class="p">(</span><span class="s">&quot;debug&quot;</span><span class="p">)</span>
<span class="o">&gt;</span><span class="w"> </span><span class="nf">with_progress</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">slow_sum</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">))</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">52.738</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">0.000</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.002</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">initiate</span><span class="o">:</span><span class="w"> </span><span class="m">0</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+0</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="p">}</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">52.739</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">0.001</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.000</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="w"> </span><span class="m">0</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+0</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="p">}</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">52.942</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">0.203</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.002</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="w"> </span><span class="m">0</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+0</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="p">}</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">53.145</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">0.407</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.001</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="w"> </span><span class="m">0</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+0</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="p">}</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">53.348</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">0.610</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.002</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="w"> </span><span class="m">1</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+1</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;P: Adding 1&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="p">}</span>
<span class="n">M</span><span class="o">:</span><span class="w"> </span><span class="n">Adding</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="m">1</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">53.555</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">0.817</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.004</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="w"> </span><span class="m">1</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+0</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;P: Adding 1&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="p">}</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">53.758</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">1.020</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.001</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="w"> </span><span class="m">1</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+0</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;P: Adding 1&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="p">}</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">53.961</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">1.223</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.001</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="w"> </span><span class="m">1</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+0</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;P: Adding 1&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="p">}</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">54.165</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">1.426</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.001</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="w"> </span><span class="m">1</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+0</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;P: Adding 1&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="p">}</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">54.368</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">1.630</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.001</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="w"> </span><span class="m">2</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+1</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;P: Adding 2&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="p">}</span>
<span class="n">M</span><span class="o">:</span><span class="w"> </span><span class="n">Adding</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="m">2</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">54.574</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">1.835</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.003</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="w"> </span><span class="m">2</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+0</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;P: Adding 2&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="p">}</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">54.777</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">2.039</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.001</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="w"> </span><span class="m">2</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+0</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;P: Adding 2&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="p">}</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">54.980</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">2.242</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.001</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="w"> </span><span class="m">2</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+0</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;P: Adding 2&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="p">}</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">55.183</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">2.445</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.001</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="w"> </span><span class="m">2</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+0</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;P: Adding 2&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="p">}</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">55.387</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">2.649</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.001</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="w"> </span><span class="m">3</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+1</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;P: Adding 3&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="p">}</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">55.388</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">2.650</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.003</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">update</span><span class="o">:</span><span class="w"> </span><span class="m">3</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+0</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;P: Adding 3&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="p">}</span>
<span class="n">M</span><span class="o">:</span><span class="w"> </span><span class="n">Adding</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="m">3</span>
<span class="p">[</span><span class="m">23</span><span class="o">:</span><span class="m">19</span><span class="o">:</span><span class="m">55.795</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="m">3.057</span><span class="n">s</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="m">+0.000</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="n">shutdown</span><span class="o">:</span><span class="w"> </span><span class="m">3</span><span class="o">/</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="m">+0</span><span class="p">)</span><span class="w"> </span><span class="s">&#39;P: Adding 3&#39;</span><span class="w"> </span><span class="p">{</span><span class="n">clear</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">enabled</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="n">ok</span><span class="p">}</span>
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./renv\library\windows\R-4.4\x86_64-w64-mingw32\progressr\doc"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Two Minimal APIs - One For Developers and One For End-Users</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#a-simple-example">A simple example</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#without-reporting-on-progress">Without reporting on progress</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reporting-on-progress">Reporting on progress</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#customizing-how-progress-is-reported">Customizing how progress is reported</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#terminal-based-progress-bars">Terminal-based progress bars</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#auditory-progress-updates">Auditory progress updates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concurrent-auditory-and-visual-progress-updates">Concurrent auditory and visual progress updates</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#silence-all-progress">Silence all progress</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#further-configuration-of-progress-handlers">Further configuration of progress handlers</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#sticky-messages">Sticky messages</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#use-regular-output-as-usual-alongside-progress-updates">Use regular output as usual alongside progress updates</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#support-for-progressr-elsewhere">Support for progressr elsewhere</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#base-r-apply-functions">Base R Apply Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-foreach-package">The foreach package</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-purrr-package">The purrr package</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-plyr-package">The plyr package</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-knitr-package">The knitr package</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#replace-any-cli-progress-bars-with-progressr-updates">Replace any cli progress bars with progressr updates</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel-processing-and-progress-updates">Parallel processing and progress updates</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#future-lapply-parallel-lapply">future_lapply() - parallel lapply()</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#foreach-with-dofuture">foreach() with doFuture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#future-map-parallel-purrr-map">future_map() - parallel purrr::map()</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#biocparallel-bplapply-parallel-lapply">BiocParallel::bplapply() - parallel lapply()</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plyr-llply-parallel-true-with-dofuture">plyr::llply(…, .parallel = TRUE) with doFuture</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#near-live-versus-buffered-progress-updates-with-futures">Near-live versus buffered progress updates with futures</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#note-of-caution-sending-progress-updates-too-frequently">Note of caution - sending progress updates too frequently</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#progress-updates-in-non-interactive-mode-batch-mode">Progress updates in non-interactive mode (“batch mode”)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#roadmap">Roadmap</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix">Appendix</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#known-issues">Known issues</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-progressor-cannot-be-created-in-the-global-environment">A progressor cannot be created in the global environment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-global-progress-handler-cannot-be-set-everywhere">The global progress handler cannot be set everywhere</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#under-the-hood">Under the hood</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#debugging">Debugging</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Brittany Cummings
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>